using Jint;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CodeLibrary.ExcuteJs
{
    public class ExcuteJsDemo
    {
        public static void ExcuteJs()
        {
            //引用：Jint
            string filePath = $"{Environment.CurrentDirectory}//ExcuteJs//TestJs.js";
            string data1 = "1";
            string data2 = "2";
            string jsCode = System.IO.File.ReadAllText(filePath);
            var square = new Engine()
                                                    .SetValue("data1", data1) // define a new variable
                                                    .SetValue("data2", data2) // define a new variable
                                                    .Execute(jsCode) // execute a statement
                                                    .GetCompletionValue() // get the latest statement completion value
                                                    .ToObject(); // converts the value to .NET
        }
    }
}
